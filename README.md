# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Данные и типы данных, используемы в приложении

Карточка

```
export interface ICard {
  _id: string;
  image: string;
  title: string;
  category: string;
  price: number | null;
  description?: string;
}
```

Структура, которая отвечает за множество карточек

```
export interface ICardData {
  cards: ICardsPreview[];
  preview: string | null;
}
```

Валидация форм

```
export interface IValidationForm {
  buttonError: boolean;
  addressError: string; 
  emailError: string; 
  phoneError: string; 
}
```

Корзина

```
export interface IBasket { 
  _id: string;
  total: number | null;
  items: ICard[];
}
```
## Архитектура приложения

Код приложения разделен на слои согласно парадигме MVP: 
- слой представления, отвечает за отображение данных на странице, 
- слой данных, отвечает за хранение и изменение данных
- презентер, отвечает за связь представления и данных.

### Базовый код

#### Класс Api
Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.
Методы: 
- `get` - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер
- `post` - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется `POST` запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

#### Класс EventEmitter
Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий.  
Основные методы, реализуемые классом описаны интерфейсом `IEvents`:
- `on` - подписка на событие
- `emit` - инициализация события
- `trigger` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие

### Слой данных

#### Класс CardsManager
Класс CardsManager управляет карточками товаров как на главной странице, так и в корзине. Он включает в себя возможность отображения всех доступных карточек, добавления карточек в корзину, а так же предварительный просмотр и удаление из корзины.
- _cards: ICard[] - массив объектов карточек.
- _preview: string | null - id карточки, выбранной для просмотра в модальной окне.
- events: IEvents - экземпляр класса `EventEmitter` для инициации событий при изменении данных.

Так же класс предоставляет набор методов для взаимодействия с этими данными.
- openCard(card: ICard): void; — Открытие карточек по клику.
- closeCard(card: ICard): void; — Закрытие карточки по нажатию на кнопку или на фон.
- getCard(cardID: string): ICard; — Получение список карточек.
- buyCard(card: ICard): void; — Добавляет карточку в корзину.
- deleteCard(cardID: string): void; — Удаляет карточку из корзины по ее ID, если нажать на кнопку добавления товара.
- а так-же сеттеры и геттеры для сохранения и получения данных из полей класса.

#### Класс Basket
Класс Basket управляет корзиной для покупок, позволяя добавлять и удалять товары, очищать корзину и получать список карточек, содержащихся в ней.
- _id: string — уникальный идентификатор корзины.
- total: number | null — общая сумма стоимости всех товаров в корзине (может быть null, если корзина пуста).
- items: ICard[] — массив объектов карточек, представляющих товары, добавленные в корзину.

Так же класс предоставляет набор методов для взаимодействия с этими данными.
- addItem(card: ICard): void — Добавляет карточку в корзину. Обновляет общую сумму корзины.
- removeItem(cardId: string): void — Удаляет карточку из корзины по её уникальному идентификатору. Обновляет общую сумму корзины.
- clear(): void — Очищает корзину, удаляя все товары и сбрасывая общую сумму.
- getItems(): ICard[] — Возвращает массив карточек, находящихся в корзине.